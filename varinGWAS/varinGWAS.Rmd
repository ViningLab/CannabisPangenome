---
title: "Varin GWAS"
author: "Brian J. Knaus"
date: "`r format(Sys.time(), '%Y, %B %d')`"
output: 
  html_document
editor_options: 
  chunk_output_type: console
---



https://www.ncbi.nlm.nih.gov/nuccore/?term=Cannabis%20ALT4

https://www.ncbi.nlm.nih.gov/search/all/?term=Cannabis%20BKR



```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(fig.width = 12)
knitr::opts_chunk$set(results = "hide")
```


## GAPIT Blink


```{r}
t1 <- Sys.time()
#library(vcfR)
```


```{r}
gwas <- read.csv("GWAS_blink_varin.csv.gz")
gwas[1:3, 1:5]
```


```{r}
nucs <- read.csv("nucs.csv.gz")
nucs[1:3, 1:5]
```



```{r}
my_pal <- c("#420A6866", "#D94D3D66", "#FCAF1366", "#BF395266", "#81206C66", 
"#62146E66", "#ED692566", "#A12A6366", "#F98B0B66", "#F6D64566"
)
```


```{r, echo=FALSE, fig.width=12, fig.cap="**Figure X** Manhattan plot."}
# png(filename = "varin_total_gwas.png", width = 6.5, height = 4, units = "in",
#    res = 300)


palette(my_pal)

plot(x = gwas$POS, y = -log10(gwas$P.value), 
#     col = vat$Chromosome,
     col = gwas$chrom_num,
     pch = 20, xlab = "", ylab = "", xaxt = "n")

abline(h = seq(0, 30, by = 1), lty = 3, col = "#C0C0C088")
abline(h = seq(0, 30, by = 5), lty = 1, col = "#C0C0C088")

axis(side = 1, at = nucs$mids, labels = c(1:9, "X"))
#axis(side = 1, at = nuc$lpos, labels = c(1:9, "X"))
#title( xlab = "Chromosome (CBDRx; GCF_900626175.2)", line = 2 )
title( xlab = "Chromosome (EH23b)", line = 2 )
title( ylab = expression("-Log"["10"](italic(p)-value)), line = 1.8 )
title( main = "Varin content (Blink model; Varin_Total)" )


# abline( v = c(69653599 + nucs$starts[4], 69653748 + nucs$starts[4]),
#         col = "#1E90FF",
# #        col = "#B22222",
#         lty = 3, lwd = 2)


#palette("default")
#dev.off()
```




```{r, results='asis'}
#plot(gwas$P.value, gwas$H.B.P.Value)
#gwas[1:3, ]
gwas2 <- gwas[sort.int(gwas$P.value, decreasing = FALSE, index.return = TRUE)$ix, ]
gwas3 <- data.frame( gwas2[, c(1, 4)],
                     '-log10(P)' = -log10(gwas2$P.value),
                     gwas2[, c(5, 6, 7, 8, 9, 3)]
                     )
names(gwas3)[3] <- "-log10(P)"
gwas3 <- gwas3[1:10, ]
#gwas3[1:3, ]


knitr::kable(gwas3, 
             caption = "**Table X.** Select results from GAPIT GWAS using the Blink model, sorted by P.value.",
             row.names = FALSE)
```



